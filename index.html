<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°½ì—…ë¹„ìš© ê³„íšì„œ ì‘ì„±</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap');

        body {
            font-family: 'Nanum Gothic', sans-serif;
            margin: 20px;
            background-color: #fff9e5;
            color: #333;
        }
        
        .banner {
            width: 100%; /* ì´ë¯¸ì§€ê°€ ë¶€ëª¨ ìš”ì†Œì— ë§ê²Œ ìë™ ì¡°ì •ë¨ */
            height: auto; /* ë¹„ìœ¨ ìœ ì§€í•˜ë©´ì„œ í¬ê¸° ì¡°ì • */
            display: block;
            margin: 0 auto 20px; /* ì•„ë˜ìª½ ì—¬ë°± 20px ì¶”ê°€ */
        }

        .form-container {
            background-color: #fcfcfced;
            padding: 20px;
            border: 3px solid #ffc107;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .form-container h2 {
            color: #d4a017;
            margin-bottom: 10px;
        }
        
        .form-container p {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .form-container p span {
            font-size: 14px;
            color: #666;
        }
        
        .form-container table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background-color: #ffffff;
        }
        
        .form-container th {
            background-color: #ffc107;
            color: #333;
            padding: 10px;
            text-align: center;
        }
        
        .form-container td {
            border: 1px solid #ffc107;
            padding: 8px;
            text-align: left;
        }
        
        .form-container .align-right {
            text-align: right;
        }
        
        .form-container .center {
            text-align: center;
        }


        h1 {
            text-align: center;
            color: #d4a017;
        }

        h2 {
            margin-top: 20px;
        }

        p {
            font-size: 18px; /* í°íŠ¸ í¬ê¸° */
            font-weight: bold; /* êµµê²Œ */
            line-height: 1.3; /* ì¤„ ê°„ê²© ì¡°ì • */
        }

        /* ì¤„ë°”ê¿ˆëœ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        p span {
            font-size: 16px; /* ë” ì‘ì€ í°íŠ¸ í¬ê¸° */
            font-weight: normal; /* ê¸°ë³¸ êµµê¸° */
            color: gray;    /* ë‹¤ë¥¸ ìƒ‰ìƒ */
            margin-top: 2px; /* ìœ„ìª½ ê°„ê²© */
            margin-bottom: 2px; /* ì•„ë˜ìª½ ê°„ê²© */
            margin-left: 25px; /* ì™¼ìª½ ì—¬ë°± */
        }

        .budget-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            font-size: 1.2em;
        }

        .budget-container span {
            margin: 0 20px;
        }

        .remaining-budget {
            font-weight: bold;
            color: #ff0000;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 2px; /* ìœ„ìª½ ê°„ê²© */
            margin-bottom: 5px; /* ì•„ë˜ìª½ ê°„ê²© */
            background-color: #ffffff;
        }

        th {
            background-color: #ffc107;
            color: #333;
            padding: 7px;
        }

        td {
            border: 1px solid #ffc107;
            padding: 7px;
            text-align: left;
        }

        /* ê¸ˆì•¡ ë°ì´í„°ë¥¼ ì˜¤ë¥¸ìª½ ì •ë ¬ */
        .align-right {
            text-align: right;
        }

        .center {
        text-align: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
        }

        input, select {
            width: 90%;
            padding: 8px;
            border: 1px solid #ffc107;
            border-radius: 4px;
        }

        button {
            padding: 10px 10px;
            background-color: #ff6347;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #e04e3f;
        }


        .add-button {
            background-color: #ffc107;
            color: rgb(0, 0, 0);
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 3px; /* ìœ„ìª½ ê°„ê²© */
        }

        .add-button:hover {
            background-color: #e0a800;
        }

        .container {
            display: flex;
            justify-content: space-between;
            gap: 10px; /* 3ë²ˆê³¼ 4ë²ˆ ì‚¬ì´ ê°„ê²© ì¡°ì ˆ */
        }

        .chart-container, .preview-container {
            width: 80%;
        }

        /* í•©ê³„ëŠ” ì˜¤ë¥¸ìª½ ì •ë ¬ */
        .total-cell {
            text-align: right; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
        }
        
        /* ì‚­ì œ ë²„íŠ¼ì€ ê°€ìš´ë° ì •ë ¬ */
        .center button {
            display: block;
            margin: 0 auto; /* ë²„íŠ¼ì„ ê°€ìš´ë° ì •ë ¬ */
            text-align: center;
        }
        
        /* "ì´ í•©ê³„" ê¸ˆì•¡ì˜ ë³¼ë“œ ì²˜ë¦¬ì™€ ì˜¤ë¥¸ìª½ ì •ë ¬ */
        .bold-right {
            text-align: right; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
            font-weight: bold; /* ë³¼ë“œ ì²˜ë¦¬ */
        }

        /* íƒœë¸”ë¦¿ í™”ë©´ (768px ~ 1024px) */
        @media (min-width: 768px) and (max-width: 1024px) {
            p {
                font-size: 16px; /* í°íŠ¸ í¬ê¸° ì¤„ì´ê¸° */
                line-height: 1.4;
            }

            .container {
                padding: 10px;
            }
        }

        /* ëª¨ë°”ì¼ í™”ë©´ (768px ì´í•˜) */
        @media (max-width: 768px) {
            .banner {
                max-width: 90%; /* ëª¨ë°”ì¼ì—ì„œëŠ” í™”ë©´ í¬ê¸°ì— ë§ê²Œ ì¡°ì • */
            }
            p {
                font-size: 14px;
            }

            .container {
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <!-- JPG ë°°ë„ˆ ì´ë¯¸ì§€ -->
    <img src="image.jpg".jpg alt="ì°½ì—…ê³„íšì„œ ë°°ë„ˆ" class="banner">

    <!-- í•­ëª© ì„¤ëª… í‘œ -->
    <div class="form-container">
        <h2 style="text-align: center; margin-bottom: 5px;" ><ì°½ì—…í•­ëª© ë° ë¹„ìš©></h2>
        <p> (1) ì‚¬ì—…ì¥ í™•ë³´ <br>
             <span>* ì‚¬ë¬´ì‹¤ í™•ë³´ì˜ ì„¸ë¶€í•­ëª©ì€ 'ì›í•˜ëŠ” í‰ìˆ˜(ì˜ˆ: 20í‰)'ì™€ 'ì›”ì„¸'ë¡œ ì…ë ¥ (ìˆ˜ëŸ‰ì€ '1'ë¡œ ê³ ì •)</span><br>
             <span>* í‰ìˆ˜ì— ë”°ë¥¸ ì´ ê³µì‚¬ ë¹„ìš© ê³„ì‚° : ì›í•˜ëŠ” í‰ìˆ˜Ã—í‰ë‹¹ ë¹„ìš©</span>
        </p>
        <table>
            <thead>
                <tr>
                    <th>í‰ìˆ˜(ã¡)</th>
                    <th>í‰ë‹¹ ë¹„ìš©</th>   
                    <th>ì´ ê³µì‚¬ ë¹„ìš©</th>
                    <th>ì›”ì„¸</th>
                    <th>ì¶”ì²œ ì—…ì¢…</th>
                    <th>ë¹„ê³ </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="center">20í‰ ì´í•˜</td>
                    <td class="align-right">30~50ë§Œì›</td>
                    <td class="align-right">600~1,000ë§Œì›</td>
                    <td class="align-right">80ë§Œì›</td>
                    <td>ì†Œí˜• ì¹´í˜, í…Œì´í¬ì•„ì›ƒ ì „ë¬¸ì , 1ì¸ ì‚¬ë¬´ì‹¤, ì†Œí˜• ë§¤ì¥ ë“±</td>
                    <td>ì¢ì€ ê³µê°„ í™œìš©í•œ ê³ íš¨ìœ¨ ì°½ì—…</td>
                </tr>
                <tr>
                    <td class="center">20~40í‰</td>
                    <td class="align-right">40~60ë§Œì›</td>
                    <td class="align-right">800~2,400ë§Œì›</td>
                    <td class="align-right">80~160ë§Œì›</td>
                    <td>ì¤‘í˜• ì¹´í˜, ìŒì‹ì (í•œì‹, ë¶„ì‹), ì†Œê·œëª¨ í•™ì›, ê°œì¸ ë¯¸ìš©ì‹¤, ë„¤ì¼ìƒµ ë“±</td>
                    <td>ëŒ€ì¤‘ì ì¸ ì†Œë¹„ì¸µ ëŒ€ìƒ ì—…ì¢… ì í•©</td>
                </tr>
                <tr>
                    <td class="center">40~60í‰</td>
                    <td class="align-right">50~80ë§Œì›</td>
                    <td class="align-right">2,000~4,800ë§Œì›</td>
                    <td class="align-right">160~240ë§Œì›</td>
                    <td>ë ˆìŠ¤í† ë‘, í”¼íŠ¸ë‹ˆìŠ¤ì„¼í„°, ì¤‘í˜• í•™ì›, ì‹¤ë‚´ ê³¨í”„ ì—°ìŠµì¥ ë“±</td>
                    <td>ê³ ì • ê³ ê° í™•ë³´ê°€ëŠ¥í•œ ì—…ì¢… ì í•©</td>
                </tr>
                <tr>
                    <td class="center">60~80í‰</td>
                    <td class="align-right">60~90ë§Œì›</td>
                    <td class="align-right">3,600~7,200ë§Œì›</td>
                    <td class="align-right">240~320ë§Œì›</td>
                    <td>í‚¤ì¦ˆì¹´í˜, ìš”ê°€ ìŠ¤íŠœë””ì˜¤, ì¤‘í˜• ì²´ìœ¡ê´€, PCë°©, ì„œì  ë“±</td>
                    <td>ë„“ì€ ê³µê°„ê³¼ íŠ¹ìˆ˜ ì¡°ëª… ë˜ëŠ” ì „ê¸° ì„¤ë¹„ í•„ìš”</td>
                </tr>
                <tr>
                    <td class="center">80í‰ ì´ìƒ</td>
                    <td class="align-right">80~100ë§Œì›</td>
                    <td class="align-right">6,400~1ì–µì› ì´ìƒ</td>
                    <td class="align-right">320~400ë§Œì›</td>
                    <td>ëŒ€í˜• ìŒì‹ì , ê²ŒìŠ¤íŠ¸ í•˜ìš°ìŠ¤, ìŠ¤í„°ë””ì¹´í˜, ê³µìš©ì˜¤í”¼ìŠ¤, ì°½ê³  ì„ëŒ€ ë“±</td>
                    <td>ë„“ì€ ê³µê°„ê³¼ ëŒ€ê·œëª¨ ê³ ê° ìˆ˜ìš© ì í•©</td>
                </tr>
            </tbody>
        </table>
        <p> (2) ì¸ë ¥ ê³ ìš© : 3ê°œì›” ìœ ì§€ <br>
            <span>* ì›”ê¸‰ ê³„ì‚° : ì‹œê¸‰Ã—8ì‹œê°„Ã—25ì¼</span>
        </p>
        <table>
            <thead>
                <tr>
                    <th>í•­ëª©</th>
                    <th>ë¹„ìš©</th>
                    <th>ë¹„ê³ </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="center">ì±„ìš© ì‚¬ì´íŠ¸ ê³µê³ </td>
                    <td class="align-right">50,000ì›</td>
                    <td>1íšŒ ê²Œì‹œ</td>
                </tr>
                <tr>
                    <td class="center">ì¸ê±´ë¹„</td>
                    <td class="align-right">2,096,270ì›</td>
                    <td>2025ë…„ ìµœì €ì‹œê¸‰ : 10,030ì›</td>
                </tr>
                <tr>
                    <td class="center">ê¸°íƒ€</td>
                    <td class="align-right">ììœ¨ ì±…ì •</td>
                    <td>1ì¸ë‹¹ 4ëŒ€ë³´í—˜ë£Œ 20ë§Œì›+a, ë³µì§€(ì ì‹¬ ì œê³µ ë“±) ë¹„ìš© í¬í•¨</td>
                </tr>
            </tbody>
        </table>
        <p> (3) ë§ˆì¼€íŒ… : 3ê°œì›” ìœ ì§€ <br>
        </p>
        <table>
            <thead>
                <tr>
                    <th>êµ¬ë¶„</th>
                    <th>í•­ëª©</th>
                    <th>ë¹„ìš©</th>
                    <th>ë¹„ê³ </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="center" rowspan="3">ì˜¤í”„ë¼ì¸</td>
                    <td>SNS ê´‘ê³ </td>
                    <td class="align-right">100,000ì›</td>
                    <td>ì¸ìŠ¤íƒ€ê·¸ë¨, í˜ì´ìŠ¤ë¶</td>
                </tr>
                <tr>
                    <td>ê²€ìƒ‰ ê´‘ê³ </td>
                    <td class="align-right">300,000ì›</td>
                    <td>êµ¬ê¸€, ë„¤ì´ë²„</td>
                </tr>
                <tr>
                    <td>ë¸”ë¡œê·¸ ì²´í—˜ë‹¨</td>
                    <td class="align-right">50,000ì›</td>
                    <td>1ê±´ë‹¹</td>
                </tr>
                <tr>
                    <td class="center" rowspan="3">ì˜¨ë¼ì¸</td>
                    <td>ì „ë‹¨ì§€ ì œì‘ ë° ë°°í¬</td>
                    <td class="align-right">150,000ì›</td>
                    <td>1,000ë¶€ë‹¹</td>
                </tr>
                <tr>
                    <td>ì˜¤í”„ë‹ ì´ë²¤íŠ¸</td>
                    <td class="align-right">500,000ì›</td>
                    <td>ìƒí’ˆ ë° í• ì¸í–‰ì‚¬</td>
                </tr>
                <tr>
                    <td>ë¡œë“œ ê´‘ê³ </td>
                    <td class="align-right">15,000ì›</td>
                    <td>í˜„ìˆ˜ë§‰, ë°°ë„ˆ</td>
                </tr>
            </tbody>
        </table>
        <p> (4) ì‹œì„¤ ì¥ë¹„ êµ¬ë§¤ : ì°½ì—…ì— í•„ìš”í•œ ì¥ë¹„, ê°€êµ¬, ì§‘ê¸° ë“± ê°€ê²© ì¡°ì‚¬ í›„ ì§ì ‘ ì…ë ¥ <br></p>
        <p> (5) ìœ ì§€ë¹„ : (1)~(4) í•­ëª©ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë¹„ìš© ì…ë ¥ <br>
            <span>* ê³µê³¼ê¸ˆ, ì†Œëª¨í’ˆ, ìœ ì§€ë³´ìˆ˜ ë° ì—…ì¢…ì— ë”°ë¥¸ ì¬ë£Œë¹„ í¬í•¨</span><br></p>

    </div> <br>
    <!-- 2. ì°½ì—…ë¹„ìš© ê³„íšì„œ (ê°€ìš´ë° ì •ë ¬, ìº¡ì²˜ ì œì™¸) -->
    <div style="text-align: center; margin-bottom: 30px;">
        <h2>ì°½ì—…í•­ëª© ì„ íƒ</h2>
    <table id="expense-table" style="margin: 0 auto;">
        <thead>
            <tr>
                <th>í•­ëª©</th>
                <th>ì„¸ë¶€ í•­ëª©</th>
                <th>ë¹„ìš© (ì›)</th>
                <th>ìˆ˜ëŸ‰</th>
                <th>í•©ê³„ (ì›)</th>
                <th>ì‘ì—…</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <select class="category-select">
                        <option value="ì‚¬ì—…ì¥ í™•ë³´">ì‚¬ì—…ì¥ í™•ë³´</option>
                        <option value="ì¸ë ¥ ê³ ìš©">ì¸ë ¥ ê³ ìš©</option>
                        <option value="ë§ˆì¼€íŒ…">ë§ˆì¼€íŒ…</option>
                        <option value="ì‹œì„¤ ì¥ë¹„ êµ¬ë§¤">ì‹œì„¤ ì¥ë¹„ êµ¬ë§¤</option>
                        <option value="ìœ ì§€ë¹„">ìœ ì§€ë¹„</option>
                    </select>
                </td>
                <td><input type="text" class="detail-input" placeholder="ì„¸ë¶€ í•­ëª© ì…ë ¥"></td>
                <td><input type="number" class="cost-input" placeholder="ë¹„ìš© ì…ë ¥"></td>
                <td><input type="number" class="quantity-input" placeholder="ìˆ˜ëŸ‰ ì…ë ¥"></td>
                <td class="total-cell align-right">0 ì›</td> <!-- í•©ê³„ëŠ” ì˜¤ë¥¸ìª½ ì •ë ¬ -->
                <td class="center"><button onclick="removeRow(this)">ì‚­ì œ</button></td> <!-- ì‚­ì œ ë²„íŠ¼ì€ ê°€ìš´ë° ì •ë ¬ -->
            </tr>
        </tbody>
    </table>
<br>
        <button class="add-button" onclick="addRow()"><b>í•­ëª© ì¶”ê°€</b></button>
    </div><br>

    <!-- ì´ˆê¸° ìë³¸ ë° ë‚¨ì€ ê¸ˆì•¡ -->
    <div class="budget-container">
        <span>ğŸ’° ì´ˆê¸° ìë³¸: <b id="initial-budget">100,000,000</b> ì›</span>
        <span>ğŸ’¸ ë‚¨ì€ ê¸ˆì•¡: <b id="remaining-budget" class="remaining-budget">100,000,000</b> </span>
    </div>


    <!-- ìº¡ì²˜í•  ì˜ì—­ ì‹œì‘ -->
    <div id="capture-area" style="padding: 20px; background-color: white; border-radius: 10px;">

        <!-- ìº¡ì²˜ì— í¬í•¨ë  "ì°½ì—…ë¹„ìš© ê³„íšì„œ" íƒ€ì´í‹€ -->
        <h1 style="text-align: center; margin-bottom: 20px;">ì°½ì—…ë¹„ìš© ê³„íšì„œ</h1>

        <!-- ê¸°ì—…ëª… ë° í•™ë²ˆ ì…ë ¥ (í•œ ì¤„) -->
        <table style="width: 100%; margin-bottom: 15px; border-collapse: collapse; text-align: center; table-layout: fixed;">
            <tr>
                <th style="background-color: #ffc107; padding: 3px; border: 1px solid #ffc107; width: 20%; font-size: 14px; line-height: 1.1; height: 25px;">
                    ê¸°ì—…ëª…
                </th>
                <td style="border: 1px solid #ffc107; padding: 3px; width: 30%; height: 25px;">
                    <input type="text" id="company-name" placeholder="ì˜ˆ: (ì£¼)ì—ì´ë¸”" 
                        style="width: 95%; height: 20px; padding: 2px; border: none; text-align: center; font-size: 14px;">
                </td>
                <th style="background-color: #ffc107; padding: 3px; border: 1px solid #ffc107; width: 20%; font-size: 14px; line-height: 1.1; height: 25px;">
                    í•™ë²ˆ ë° ì´ë¦„
                </th>
                <td style="border: 1px solid #ffc107; padding: 3px; width: 30%; height: 25px;">
                    <input type="text" id="student-name" placeholder="ì˜ˆ: 300719 ì†¡ë‹¤ìœ¤" 
                        style="width: 95%; height: 20px; padding: 2px; border: none; text-align: center; font-size: 14px;">
                </td>
            </tr>
        </table>


        <div class="container" style="display: flex; justify-content: space-between; gap: 10px;">

            <!-- ì™¼ìª½: ê²°ê³¼ -->
        <div style="width: 120%;">
            <div class="preview-container">
                <h2>ì°½ì—…ë¹„ìš© ê³„íšì„œ</h2>
                <table id="preview-table">
                    <thead>
                        <tr>
                            <th>í•­ëª©</th>
                            <th>ì„¸ë¶€ í•­ëª©</th>
                            <th>ë¹„ìš© (ì›)</th>
                            <th>ìˆ˜ëŸ‰</th>
                            <th>í•©ê³„ (ì›)</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4" style="text-align: right; font-weight: bold;">ì´ í•©ê³„</td>
                            <td id="total-preview-cost" class="bold-right">0 ì›</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>


            <!-- ì˜¤ë¥¸ìª½: 4. ì°¨íŠ¸ -->
            <div class="chart-container" style="width: 45%;">
                <h2>ì°¨íŠ¸</h2>
                <canvas id="expenseChart"></canvas>
            </div>

        </div> <!-- container ë -->
    </div> <!-- capture-area ë -->


    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        let remainingBudget = 100000000;
        const data = {
            "ì‚¬ì—…ì¥ í™•ë³´": 0,
            "ì¸ë ¥ ê³ ìš©": 0,
            "ë§ˆì¼€íŒ…": 0,
            "ì‹œì„¤ ì¥ë¹„ êµ¬ë§¤": 0,
            "ìœ ì§€ë¹„": 0
        };
        let chartInstance;

        function addRow() {
            const table = document.getElementById('expense-table').querySelector('tbody');
            const newRow = document.createElement('tr');

            newRow.innerHTML = `
                <td>
                    <select class="category-select">
                        <option value="ì‚¬ì—…ì¥ í™•ë³´">ì‚¬ì—…ì¥ í™•ë³´</option>
                        <option value="ì¸ë ¥ ê³ ìš©">ì¸ë ¥ ê³ ìš©</option>
                        <option value="ë§ˆì¼€íŒ…">ë§ˆì¼€íŒ…</option>
                        <option value="ì‹œì„¤ ì¥ë¹„ êµ¬ë§¤">ì‹œì„¤ ì¥ë¹„ êµ¬ë§¤</option>
                        <option value="ìœ ì§€ë¹„">ìœ ì§€ë¹„</option>
                    </select>
                </td>
                <td><input type="text" class="detail-input" placeholder="ì„¸ë¶€ í•­ëª© ì…ë ¥"></td>
                <td><input type="number" class="cost-input" placeholder="ë¹„ìš© ì…ë ¥"></td>
                <td><input type="number" class="quantity-input" placeholder="ìˆ˜ëŸ‰ ì…ë ¥"></td>
                <td class="total-cell">0 ì›</td>
                <td class="center"><button onclick="removeRow(this)">ì‚­ì œ</button></td>
            `;
            table.appendChild(newRow);
            addInputListeners(newRow);
        }

        function removeRow(button) {
            const row = button.parentElement.parentElement;
            row.remove();
            updateData();
        }

        function addInputListeners(row) {
            const inputs = row.querySelectorAll('.cost-input, .quantity-input, .category-select');
            inputs.forEach(input => input.addEventListener('input', updateData));
        }

        function updateData() {
            const rows = document.querySelectorAll('#expense-table tbody tr'); // ì…ë ¥ í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ ì„ íƒ
            const previewTableBody = document.querySelector('#preview-table tbody'); // ë¯¸ë¦¬ë³´ê¸° í…Œì´ë¸”
            let totalExpense = 0; // ì´ ì‚¬ìš© ê¸ˆì•¡ ì´ˆê¸°í™”

            // ì´ˆê¸° ë°ì´í„° ë¦¬ì…‹
            for (let key in data) {
                data[key] = 0;
            }
            previewTableBody.innerHTML = ''; // ë¯¸ë¦¬ë³´ê¸° í…Œì´ë¸” ì´ˆê¸°í™”

            // ì…ë ¥ í…Œì´ë¸” ë°ì´í„°ë¥¼ ì½ê³  ê³„ì‚°
            rows.forEach(row => {
                const category = row.querySelector('.category-select').value; // í•­ëª©
                const detail = row.querySelector('.detail-input').value || '-'; // ì„¸ë¶€ í•­ëª©
                const cost = parseInt(row.querySelector('.cost-input').value) || 0; // ë¹„ìš©
                const quantity = parseInt(row.querySelector('.quantity-input').value) || 0; // ìˆ˜ëŸ‰
                const total = cost * quantity; // í•©ê³„ ê³„ì‚°

                // ë°ì´í„° ì—…ë°ì´íŠ¸
                data[category] += total;
                totalExpense += total;

                // ë¯¸ë¦¬ë³´ê¸° í…Œì´ë¸” ì—…ë°ì´íŠ¸
                const previewRow = document.createElement('tr');
                previewRow.innerHTML = `
                    <td>${category}</td>
                    <td>${detail}</td>
                    <td class="align-right">${cost.toLocaleString()} ì›</td>
                    <td>${quantity}</td>
                    <td class="align-right">${total.toLocaleString()} ì›</td>
                `;
                previewTableBody.appendChild(previewRow);

                // ì…ë ¥ í…Œì´ë¸”ì˜ í˜„ì¬ í–‰ì— í•©ê³„ ì—…ë°ì´íŠ¸
                const totalCell = row.querySelector('.total-cell');
                totalCell.textContent = `${total.toLocaleString()} ì›`;
            });

            // ì‚¬ìš©í•œ ê¸ˆì•¡ ë° ë‚¨ì€ ê¸ˆì•¡ ì—…ë°ì´íŠ¸
            remainingBudget = 100000000 - totalExpense; // ì´ˆê¸° ìë³¸ì—ì„œ ì´ ì‚¬ìš© ê¸ˆì•¡ ì°¨ê°
            document.getElementById('remaining-budget').textContent = `${remainingBudget.toLocaleString()} ì›`;
            document.getElementById('total-preview-cost').textContent = `${totalExpense.toLocaleString()} ì›`;

            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            drawChart();
        }

        function drawChart() {
            const ctx = document.getElementById('expenseChart').getContext('2d');
            const labels = Object.keys(data);
            const values = Object.values(data);
            const totalValue = values.reduce((acc, val) => acc + val, 0); // ì´ í•©ê³„ ê³„ì‚°

            if (chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels,
                    datasets: [{
                        data: values,
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                    }]
                },
                options: {
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const percentage = ((value / totalValue) * 100).toFixed(2); // í¼ì„¼íŠ¸ ê³„ì‚°
                                    return `${label}: ${percentage}% (${value.toLocaleString()} ì›)`;
                                }
                            }
                        },
                        datalabels: {
                            formatter: (value, context) => {
                                if (value === 0) {
                                    return ''; // ê°’ì´ 0ì´ë©´ ì•„ë¬´ ê²ƒë„ í‘œì‹œí•˜ì§€ ì•ŠìŒ
                                }
                                const percentage = ((value / totalValue) * 100).toFixed(2); // í¼ì„¼íŠ¸ ê³„ì‚°
                                return `${percentage}%`; // % ê°’ë§Œ í‘œì‹œ
                            },
                            color: '#fff', // í…ìŠ¤íŠ¸ ìƒ‰ìƒ
                            font: {
                                size: 14, // í°íŠ¸ í¬ê¸°
                                weight: 'bold' // í°íŠ¸ êµµê¸°
                            },
                            anchor: 'end',
                            align: 'start',
                            offset: 10
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }


        document.querySelectorAll('#expense-table tbody tr').forEach(addInputListeners);

            // â˜… ì…ë ¥ í•„ë“œë¥¼ í•œê¸€ ëª¨ë“œë¡œ ì„¤ì •í•˜ëŠ” ì½”ë“œ ì¶”ê°€ â˜…
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('focus', () => {
                    input.setAttribute('lang', 'ko');
                });
            });

        function saveAsImage() {
            const captureElement = document.getElementById('capture-area');

            html2canvas(captureElement, {
                backgroundColor: '#ffffff', // ë°°ê²½ í°ìƒ‰ìœ¼ë¡œ ì„¤ì •
                scale: 2, // ì´ë¯¸ì§€ í•´ìƒë„ í–¥ìƒ
                useCORS: true // ì™¸ë¶€ ì´ë¯¸ì§€ ë¬¸ì œ ë°©ì§€
            }).then(canvas => {
                const link = document.createElement('a');
                link.href = canvas.toDataURL("image/png");
                link.download = "ì°½ì—…ë¹„ìš©ê³„íšì„œ.png";
                link.click();
            });
        }


    </script>

        <div style="text-align: center; margin-top: 20px;">
            <button class="add-button" onclick="saveAsImage()">ì´ë¯¸ì§€ ì €ì¥</button>
        </div>



</body>
</html>
