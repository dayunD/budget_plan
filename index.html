<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>창업비용 계획서 작성</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap');

        body {
            font-family: 'Nanum Gothic', sans-serif;
            margin: 20px;
            background-color: #fff9e5;
            color: #333;
        }
        
        .banner {
            width: 100%; /* 이미지가 부모 요소에 맞게 자동 조정됨 */
            height: auto; /* 비율 유지하면서 크기 조정 */
            display: block;
            margin: 0 auto 20px; /* 아래쪽 여백 20px 추가 */
        }

        .form-container {
            background-color: #fcfcfced;
            padding: 20px;
            border: 3px solid #ffc107;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .form-container h2 {
            color: #d4a017;
            margin-bottom: 10px;
        }
        
        .form-container p {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .form-container p span {
            font-size: 14px;
            color: #666;
        }
        
        .form-container table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background-color: #ffffff;
        }
        
        .form-container th {
            background-color: #ffc107;
            color: #333;
            padding: 10px;
            text-align: center;
        }
        
        .form-container td {
            border: 1px solid #ffc107;
            padding: 8px;
            text-align: left;
        }
        
        .form-container .align-right {
            text-align: right;
        }
        
        .form-container .center {
            text-align: center;
        }


        h1 {
            text-align: center;
            color: #d4a017;
        }

        h2 {
            margin-top: 20px;
        }

        p {
            font-size: 18px; /* 폰트 크기 */
            font-weight: bold; /* 굵게 */
            line-height: 1.3; /* 줄 간격 조정 */
        }

        /* 줄바꿈된 텍스트 스타일 */
        p span {
            font-size: 16px; /* 더 작은 폰트 크기 */
            font-weight: normal; /* 기본 굵기 */
            color: gray;    /* 다른 색상 */
            margin-top: 2px; /* 위쪽 간격 */
            margin-bottom: 2px; /* 아래쪽 간격 */
            margin-left: 25px; /* 왼쪽 여백 */
        }

        .budget-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            font-size: 1.2em;
        }

        .budget-container span {
            margin: 0 20px;
        }

        .remaining-budget {
            font-weight: bold;
            color: #ff0000;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 2px; /* 위쪽 간격 */
            margin-bottom: 5px; /* 아래쪽 간격 */
            background-color: #ffffff;
        }

        th {
            background-color: #ffc107;
            color: #333;
            padding: 7px;
        }

        td {
            border: 1px solid #ffc107;
            padding: 7px;
            text-align: left;
        }

        /* 금액 데이터를 오른쪽 정렬 */
        .align-right {
            text-align: right;
        }

        .center {
        text-align: center; /* 가로 중앙 정렬 */
        }

        input, select {
            width: 90%;
            padding: 8px;
            border: 1px solid #ffc107;
            border-radius: 4px;
        }

        button {
            padding: 10px 10px;
            background-color: #ff6347;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #e04e3f;
        }


        .add-button {
            background-color: #ffc107;
            color: rgb(0, 0, 0);
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 3px; /* 위쪽 간격 */
        }

        .add-button:hover {
            background-color: #e0a800;
        }

        .container {
            display: flex;
            justify-content: space-between;
            gap: 10px; /* 3번과 4번 사이 간격 조절 */
        }

        .chart-container, .preview-container {
            width: 80%;
        }

        /* 합계는 오른쪽 정렬 */
        .total-cell {
            text-align: right; /* 오른쪽 정렬 */
        }
        
        /* 삭제 버튼은 가운데 정렬 */
        .center button {
            display: block;
            margin: 0 auto; /* 버튼을 가운데 정렬 */
            text-align: center;
        }
        
        /* "총 합계" 금액의 볼드 처리와 오른쪽 정렬 */
        .bold-right {
            text-align: right; /* 오른쪽 정렬 */
            font-weight: bold; /* 볼드 처리 */
        }

        /* 태블릿 화면 (768px ~ 1024px) */
        @media (min-width: 768px) and (max-width: 1024px) {
            p {
                font-size: 16px; /* 폰트 크기 줄이기 */
                line-height: 1.4;
            }

            .container {
                padding: 10px;
            }
        }

        /* 모바일 화면 (768px 이하) */
        @media (max-width: 768px) {
            .banner {
                max-width: 90%; /* 모바일에서는 화면 크기에 맞게 조정 */
            }
            p {
                font-size: 14px;
            }

            .container {
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <!-- JPG 배너 이미지 -->
    <img src="image.jpg".jpg alt="창업계획서 배너" class="banner">

    <!-- 항목 설명 표 -->
    <div class="form-container">
        <h2 style="text-align: center; margin-bottom: 5px;" ><창업항목 및 비용></h2>
        <p> (1) 사업장 확보 <br>
             <span>* 사무실 확보의 세부항목은 '원하는 평수(예: 20평)'와 '월세'로 입력 (수량은 '1'로 고정)</span><br>
             <span>* 평수에 따른 총 공사 비용 계산 : 원하는 평수×평당 비용</span>
        </p>
        <table>
            <thead>
                <tr>
                    <th>평수(㎡)</th>
                    <th>평당 비용</th>   
                    <th>총 공사 비용</th>
                    <th>월세</th>
                    <th>추천 업종</th>
                    <th>비고</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="center">20평 이하</td>
                    <td class="align-right">30~50만원</td>
                    <td class="align-right">600~1,000만원</td>
                    <td class="align-right">80만원</td>
                    <td>소형 카페, 테이크아웃 전문점, 1인 사무실, 소형 매장 등</td>
                    <td>좁은 공간 활용한 고효율 창업</td>
                </tr>
                <tr>
                    <td class="center">20~40평</td>
                    <td class="align-right">40~60만원</td>
                    <td class="align-right">800~2,400만원</td>
                    <td class="align-right">80~160만원</td>
                    <td>중형 카페, 음식점(한식, 분식), 소규모 학원, 개인 미용실, 네일샵 등</td>
                    <td>대중적인 소비층 대상 업종 적합</td>
                </tr>
                <tr>
                    <td class="center">40~60평</td>
                    <td class="align-right">50~80만원</td>
                    <td class="align-right">2,000~4,800만원</td>
                    <td class="align-right">160~240만원</td>
                    <td>레스토랑, 피트니스센터, 중형 학원, 실내 골프 연습장 등</td>
                    <td>고정 고객 확보가능한 업종 적합</td>
                </tr>
                <tr>
                    <td class="center">60~80평</td>
                    <td class="align-right">60~90만원</td>
                    <td class="align-right">3,600~7,200만원</td>
                    <td class="align-right">240~320만원</td>
                    <td>키즈카페, 요가 스튜디오, 중형 체육관, PC방, 서점 등</td>
                    <td>넓은 공간과 특수 조명 또는 전기 설비 필요</td>
                </tr>
                <tr>
                    <td class="center">80평 이상</td>
                    <td class="align-right">80~100만원</td>
                    <td class="align-right">6,400~1억원 이상</td>
                    <td class="align-right">320~400만원</td>
                    <td>대형 음식점, 게스트 하우스, 스터디카페, 공용오피스, 창고 임대 등</td>
                    <td>넓은 공간과 대규모 고객 수용 적합</td>
                </tr>
            </tbody>
        </table>
        <p> (2) 인력 고용 : 3개월 유지 <br>
            <span>* 월급 계산 : 시급×8시간×25일</span>
        </p>
        <table>
            <thead>
                <tr>
                    <th>항목</th>
                    <th>비용</th>
                    <th>비고</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="center">채용 사이트 공고</td>
                    <td class="align-right">50,000원</td>
                    <td>1회 게시</td>
                </tr>
                <tr>
                    <td class="center">인건비</td>
                    <td class="align-right">2,096,270원</td>
                    <td>2025년 최저시급 : 10,030원</td>
                </tr>
                <tr>
                    <td class="center">기타</td>
                    <td class="align-right">자율 책정</td>
                    <td>1인당 4대보험료 20만원+a, 복지(점심 제공 등) 비용 포함</td>
                </tr>
            </tbody>
        </table>
        <p> (3) 마케팅 : 3개월 유지 <br>
        </p>
        <table>
            <thead>
                <tr>
                    <th>구분</th>
                    <th>항목</th>
                    <th>비용</th>
                    <th>비고</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="center" rowspan="3">오프라인</td>
                    <td>SNS 광고</td>
                    <td class="align-right">100,000원</td>
                    <td>인스타그램, 페이스북</td>
                </tr>
                <tr>
                    <td>검색 광고</td>
                    <td class="align-right">300,000원</td>
                    <td>구글, 네이버</td>
                </tr>
                <tr>
                    <td>블로그 체험단</td>
                    <td class="align-right">50,000원</td>
                    <td>1건당</td>
                </tr>
                <tr>
                    <td class="center" rowspan="3">온라인</td>
                    <td>전단지 제작 및 배포</td>
                    <td class="align-right">150,000원</td>
                    <td>1,000부당</td>
                </tr>
                <tr>
                    <td>오프닝 이벤트</td>
                    <td class="align-right">500,000원</td>
                    <td>상품 및 할인행사</td>
                </tr>
                <tr>
                    <td>로드 광고</td>
                    <td class="align-right">15,000원</td>
                    <td>현수막, 배너</td>
                </tr>
            </tbody>
        </table>
        <p> (4) 시설 장비 구매 : 창업에 필요한 장비, 가구, 집기 등 가격 조사 후 직접 입력 <br></p>
        <p> (5) 유지비 : (1)~(4) 항목을 제외한 나머지 비용 입력 <br>
            <span>* 공과금, 소모품, 유지보수 및 업종에 따른 재료비 포함</span><br></p>

    </div> <br>
    <!-- 2. 창업비용 계획서 (가운데 정렬, 캡처 제외) -->
    <div style="text-align: center; margin-bottom: 30px;">
        <h2>창업항목 선택</h2>
    <table id="expense-table" style="margin: 0 auto;">
        <thead>
            <tr>
                <th>항목</th>
                <th>세부 항목</th>
                <th>비용 (원)</th>
                <th>수량</th>
                <th>합계 (원)</th>
                <th>작업</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <select class="category-select">
                        <option value="사업장 확보">사업장 확보</option>
                        <option value="인력 고용">인력 고용</option>
                        <option value="마케팅">마케팅</option>
                        <option value="시설 장비 구매">시설 장비 구매</option>
                        <option value="유지비">유지비</option>
                    </select>
                </td>
                <td><input type="text" class="detail-input" placeholder="세부 항목 입력"></td>
                <td><input type="number" class="cost-input" placeholder="비용 입력"></td>
                <td><input type="number" class="quantity-input" placeholder="수량 입력"></td>
                <td class="total-cell align-right">0 원</td> <!-- 합계는 오른쪽 정렬 -->
                <td class="center"><button onclick="removeRow(this)">삭제</button></td> <!-- 삭제 버튼은 가운데 정렬 -->
            </tr>
        </tbody>
    </table>
<br>
        <button class="add-button" onclick="addRow()"><b>항목 추가</b></button>
    </div><br>

    <!-- 초기 자본 및 남은 금액 -->
    <div class="budget-container">
        <span>💰 초기 자본: <b id="initial-budget">100,000,000</b> 원</span>
        <span>💸 남은 금액: <b id="remaining-budget" class="remaining-budget">100,000,000</b> </span>
    </div>


    <!-- 캡처할 영역 시작 -->
    <div id="capture-area" style="padding: 20px; background-color: white; border-radius: 10px;">

        <!-- 캡처에 포함될 "창업비용 계획서" 타이틀 -->
        <h1 style="text-align: center; margin-bottom: 20px;">창업비용 계획서</h1>

        <!-- 기업명 및 학번 입력 (한 줄) -->
        <table style="width: 100%; margin-bottom: 15px; border-collapse: collapse; text-align: center; table-layout: fixed;">
            <tr>
                <th style="background-color: #ffc107; padding: 3px; border: 1px solid #ffc107; width: 20%; font-size: 14px; line-height: 1.1; height: 25px;">
                    기업명
                </th>
                <td style="border: 1px solid #ffc107; padding: 3px; width: 30%; height: 25px;">
                    <input type="text" id="company-name" placeholder="예: (주)에이블" 
                        style="width: 95%; height: 20px; padding: 2px; border: none; text-align: center; font-size: 14px;">
                </td>
                <th style="background-color: #ffc107; padding: 3px; border: 1px solid #ffc107; width: 20%; font-size: 14px; line-height: 1.1; height: 25px;">
                    학번 및 이름
                </th>
                <td style="border: 1px solid #ffc107; padding: 3px; width: 30%; height: 25px;">
                    <input type="text" id="student-name" placeholder="예: 300719 송다윤" 
                        style="width: 95%; height: 20px; padding: 2px; border: none; text-align: center; font-size: 14px;">
                </td>
            </tr>
        </table>


        <div class="container" style="display: flex; justify-content: space-between; gap: 10px;">

            <!-- 왼쪽: 결과 -->
        <div style="width: 120%;">
            <div class="preview-container">
                <h2>창업비용 계획서</h2>
                <table id="preview-table">
                    <thead>
                        <tr>
                            <th>항목</th>
                            <th>세부 항목</th>
                            <th>비용 (원)</th>
                            <th>수량</th>
                            <th>합계 (원)</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4" style="text-align: right; font-weight: bold;">총 합계</td>
                            <td id="total-preview-cost" class="bold-right">0 원</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>


            <!-- 오른쪽: 4. 차트 -->
            <div class="chart-container" style="width: 45%;">
                <h2>차트</h2>
                <canvas id="expenseChart"></canvas>
            </div>

        </div> <!-- container 끝 -->
    </div> <!-- capture-area 끝 -->


    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script>
        let remainingBudget = 100000000;
        const data = {
            "사업장 확보": 0,
            "인력 고용": 0,
            "마케팅": 0,
            "시설 장비 구매": 0,
            "유지비": 0
        };
        let chartInstance;

        function addRow() {
            const table = document.getElementById('expense-table').querySelector('tbody');
            const newRow = document.createElement('tr');

            newRow.innerHTML = `
                <td>
                    <select class="category-select">
                        <option value="사업장 확보">사업장 확보</option>
                        <option value="인력 고용">인력 고용</option>
                        <option value="마케팅">마케팅</option>
                        <option value="시설 장비 구매">시설 장비 구매</option>
                        <option value="유지비">유지비</option>
                    </select>
                </td>
                <td><input type="text" class="detail-input" placeholder="세부 항목 입력"></td>
                <td><input type="number" class="cost-input" placeholder="비용 입력"></td>
                <td><input type="number" class="quantity-input" placeholder="수량 입력"></td>
                <td class="total-cell">0 원</td>
                <td class="center"><button onclick="removeRow(this)">삭제</button></td>
            `;
            table.appendChild(newRow);
            addInputListeners(newRow);
        }

        function removeRow(button) {
            const row = button.parentElement.parentElement;
            row.remove();
            updateData();
        }

        function addInputListeners(row) {
            const inputs = row.querySelectorAll('.cost-input, .quantity-input, .category-select');
            inputs.forEach(input => input.addEventListener('input', updateData));
        }

        function updateData() {
            const rows = document.querySelectorAll('#expense-table tbody tr'); // 입력 테이블의 모든 행 선택
            const previewTableBody = document.querySelector('#preview-table tbody'); // 미리보기 테이블
            let totalExpense = 0; // 총 사용 금액 초기화

            // 초기 데이터 리셋
            for (let key in data) {
                data[key] = 0;
            }
            previewTableBody.innerHTML = ''; // 미리보기 테이블 초기화

            // 입력 테이블 데이터를 읽고 계산
            rows.forEach(row => {
                const category = row.querySelector('.category-select').value; // 항목
                const detail = row.querySelector('.detail-input').value || '-'; // 세부 항목
                const cost = parseInt(row.querySelector('.cost-input').value) || 0; // 비용
                const quantity = parseInt(row.querySelector('.quantity-input').value) || 0; // 수량
                const total = cost * quantity; // 합계 계산

                // 데이터 업데이트
                data[category] += total;
                totalExpense += total;

                // 미리보기 테이블 업데이트
                const previewRow = document.createElement('tr');
                previewRow.innerHTML = `
                    <td>${category}</td>
                    <td>${detail}</td>
                    <td class="align-right">${cost.toLocaleString()} 원</td>
                    <td>${quantity}</td>
                    <td class="align-right">${total.toLocaleString()} 원</td>
                `;
                previewTableBody.appendChild(previewRow);

                // 입력 테이블의 현재 행에 합계 업데이트
                const totalCell = row.querySelector('.total-cell');
                totalCell.textContent = `${total.toLocaleString()} 원`;
            });

            // 사용한 금액 및 남은 금액 업데이트
            remainingBudget = 100000000 - totalExpense; // 초기 자본에서 총 사용 금액 차감
            document.getElementById('remaining-budget').textContent = `${remainingBudget.toLocaleString()} 원`;
            document.getElementById('total-preview-cost').textContent = `${totalExpense.toLocaleString()} 원`;

            // 차트 업데이트
            drawChart();
        }

        function drawChart() {
            const ctx = document.getElementById('expenseChart').getContext('2d');
            const labels = Object.keys(data);
            const values = Object.values(data);
            const totalValue = values.reduce((acc, val) => acc + val, 0); // 총 합계 계산

            if (chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels,
                    datasets: [{
                        data: values,
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                    }]
                },
                options: {
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const percentage = ((value / totalValue) * 100).toFixed(2); // 퍼센트 계산
                                    return `${label}: ${percentage}% (${value.toLocaleString()} 원)`;
                                }
                            }
                        },
                        datalabels: {
                            formatter: (value, context) => {
                                if (value === 0) {
                                    return ''; // 값이 0이면 아무 것도 표시하지 않음
                                }
                                const percentage = ((value / totalValue) * 100).toFixed(2); // 퍼센트 계산
                                return `${percentage}%`; // % 값만 표시
                            },
                            color: '#fff', // 텍스트 색상
                            font: {
                                size: 14, // 폰트 크기
                                weight: 'bold' // 폰트 굵기
                            },
                            anchor: 'end',
                            align: 'start',
                            offset: 10
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }


        document.querySelectorAll('#expense-table tbody tr').forEach(addInputListeners);

            // ★ 입력 필드를 한글 모드로 설정하는 코드 추가 ★
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('focus', () => {
                    input.setAttribute('lang', 'ko');
                });
            });

        function saveAsImage() {
            const captureElement = document.getElementById('capture-area');

            html2canvas(captureElement, {
                backgroundColor: '#ffffff', // 배경 흰색으로 설정
                scale: 2, // 이미지 해상도 향상
                useCORS: true // 외부 이미지 문제 방지
            }).then(canvas => {
                const link = document.createElement('a');
                link.href = canvas.toDataURL("image/png");
                link.download = "창업비용계획서.png";
                link.click();
            });
        }


    </script>

        <div style="text-align: center; margin-top: 20px;">
            <button class="add-button" onclick="saveAsImage()">이미지 저장</button>
        </div>



</body>
</html>
